better handling of api keys
